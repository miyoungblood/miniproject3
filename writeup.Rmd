---
title: "practice"
author: "Jordan Moody"
date: "4/10/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
```

## Making table of number of movies in each rating
```{r}
db %>%
  dbGetQuery("SELECT *
             FROM info_type;")

```
```{r}
db %>%
  dbGetQuery("SELECT *
             FROM movie_info
             WHERE info_type_id = 97
             LIMIT 0,10;")
```
```{r}
db %>%
  dbGetQuery("SELECT *
             FROM title
GROUP BY production_year
             LIMIT 0, 10")
```
### Gross is info_type_id = 107
Country is info_type_id = 8 (filter for USA)
MPAA is info_type_id = 97 (filter '%Rated R%' or similar)
```{r}
db %>%
  dbGetQuery("SELECT t.production_year, t.id, mi.info_type_id
             FROM title t
             JOIN movie_info mi ON t.id = mi.movie_id
             WHERE mi.info_type_id = 97
             GROUP BY t.production_year
             LIMIT 0, 10")
```
```{r}
db %>%
  dbGetQuery("SELECT t.production_year, sum(mi.info_type_id) AS num_R
             FROM title t
             JOIN movie_info mi ON t.id = mi.movie_id
             WHERE mi.info_type_id = 97
             AND info LIKE 'Rated R'
             GROUP BY t.production_year;")

```
###Why is it not taking year as numbers?

##STEPS
1. make table of total number of movies each year and total number of R rated movies each year (percentage of movies each year rated r)
2. make table of different reasons for r rating 
3. make two graphs, one with percentage of movies rated r and one with reasons (different colors, both over time)